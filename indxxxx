<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حساب مدة الإجازة</title>
    <!-- إضافة مكتبة Flatpickr -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .section {
            margin-bottom: 20px;
        }
        .message {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>&& اعداد: باحث اقدم / نزار محمد كاظم الكعبي && مديرية ادارة الموارد البشرية / مديرية الموظفين المدنيين</h1>

        <!-- قسم حساب المدة بين بوكس 1 إلى بوكس 5 -->
        <div class="section">
            <h2>حساب المدة الكلية والمستقطعة والمتبقية من الاجازة</h2>

            <!-- حقل اكتب عدد الأيام -->
            <div>
                <label for="textbox11">اكتب عدد الأيام:</label>
                <input type="number" id="textbox11">
            </div>

            <!-- الراديو بوتنز -->
            <div>
                <label>خيارات إضافية :</label>
                <div>
                    <input type="radio" id="radio1" name="duration" value="15"> 15 يومًا
                    <input type="radio" id="radio2" name="duration" value="30"> شهر
                    <input type="radio" id="radio3" name="duration" value="180"> ستة أشهر
                    <input type="radio" id="radio4" name="duration" value="365"> سنة
                </div>
            </div>

            <div>
                <label for="textbox1">تاريخ الانفكاك:</label>
                <input type="text" id="textbox1" required>
            </div>
            <div>
                <label for="textbox2">تاريخ انتهاء الإجازة:</label>
                <input type="text" id="textbox2" required>
            </div>
            <div>
                <label for="textbox3">تاريخ المباشرة:</label>
                <input type="text" id="textbox3">
            </div>

            <!-- زر حساب المدة -->
            <button id="calculateButton">اضغط لحساب المدة المتبقية </button>
            <div id="message-duration" class="message"></div>
        </div>

        <!-- عرض النتائج -->
        <div class="section results">
            <h3>نتائج الحساب</h3>
            <div>
                <label>المدة الكلية:</label>
                <span id="resultTextBox4"></span>
            let yearsDifference = endDate.getFullYear() - startDate.getFullYear();
            let monthsDifference = endDate.getMonth() - startDate.getMonth();
            let daysDifference = endDate.getDate() - startDate.getDate();

            if (daysDifference < 0) {
                monthsDifference--;
                daysDifference += new Date(startDate.getFullYear(), startDate.getMonth() + 1, 0).getDate();
            }

            if (monthsDifference < 0) {
                yearsDifference--;
                monthsDifference += 12;
            }

            return `${yearsDifference} سنة ${monthsDifference} شهر ${daysDifference} يوم`;
        }

        // حساب 51 يوم
        document.getElementById('calculate51Button').addEventListener('click', function() {
            let date51 = new Date(document.getElementById('textbox7').value);
            let message51days = document.getElementById('message-51days');
            let result51days = document.getElementById('result51days');

            // إعادة تعيين الرسائل السابقة
            message51days.innerText = '';
            result51days.innerText = '';

            if (!date51) {
                message51days.innerText = 'يرجى إدخال تاريخ بداية.';
                return;
            }

            // حساب تاريخ النهاية بعد 51 يومًا
            let newDate51 = new Date(date51);
            newDate51.setDate(newDate51.getDate() + 51);
            result51days.innerText = newDate51.toISOString().split('T')[0];
        });

        // حساب الرصيد
        document.getElementById('calculateBalanceButton').addEventListener('click', function() {
            let hireDate = new Date(document.getElementById('textbox8').value);
            let currentDate = new Date(document.getElementById('textbox9').value);
            let usedLeave = document.getElementById('textbox10').value;
            let label12 = document.getElementById('label12');
            let label13 = document.getElementById('label13');
            let messageBalance = document.getElementById('message-balance');

            // إعادة تعيين الرسائل والنتائج السابقة
            label12.innerText = '';
            label13.innerText = '';
            messageBalance.innerText = '';

            // التحقق من صحة المدخلات
            if (!hireDate || !currentDate) {
                messageBalance.innerText = 'يرجى إدخال تاريخ التعيين والتاريخ الحالي.';
                return;
            }

            if (hireDate > currentDate) {
                messageBalance.innerText = 'يجب أن يكون التاريخ الحالي أكبر من أو يساوي تاريخ التعيين.';
                return;
            }

            if (usedLeave && isNaN(usedLeave)) {
                messageBalance.innerText = 'يرجى إدخال عدد الإجازات المستخدمة بشكل صحيح.';
                return;
            }

            // حساب المدة بين تاريخ التعيين والتاريخ الحالي
            let totalDays = calculateDateDifferenceInDays(hireDate, currentDate);
            let yearsDifference = currentDate.getFullYear() - hireDate.getFullYear();
            let monthsDifference = currentDate.getMonth() - hireDate.getMonth();
            let daysDifference = currentDate.getDate() - hireDate.getDate();

            if (daysDifference < 0) {
                monthsDifference--;
                daysDifference += new Date(currentDate.getFullYear(), currentDate.getMonth(), 0).getDate();
            }

            if (monthsDifference < 0) {
                yearsDifference--;
                monthsDifference += 12;
            }

            // حساب الرصيد المتاح بناءً على عدد الأيام
            let yearsInDays = yearsDifference * 36;
            let monthsInDays = monthsDifference * 3;
            let daysInDays = Math.floor(daysDifference / 10); // يتم حساب يوم واحد لكل 10 أيام

            let totalDaysAvailable = yearsInDays + monthsInDays + daysInDays - (usedLeave ? parseInt(usedLeave) : 0);

            // عرض النتائج
            label12.innerText = totalDaysAvailable.toString();
            label13.innerText = `${yearsDifference} سنة ${monthsDifference} شهر ${daysDifference} يوم`;
        });

        // حساب الفرق بين التواريخ بالأيام (رقم الأيام)
        function calculateDateDifferenceInDays(startDate, endDate) {
            return Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24));
        }

        // زر إعادة تعيين
        document.getElementById('resetButton').addEventListener('click', function() {
            // مسح جميع القيم
            document.getElementById('textbox1').value = '';
            document.getElementById('textbox2').value = '';
            document.getElementById('textbox3').value = '';
            document.getElementById('textbox7').value = '';
            document.getElementById('textbox8').value = '';
            document.getElementById('textbox9').value = '';
            document.getElementById('textbox10').value = '';
            document.getElementById('textbox11').value = '';

            // مسح النتائج
            document.getElementById('resultTextBox4').innerText = '';
            document.getElementById('resultTextBox5').innerText = '';
            document.getElementById('resultTextBox6').innerText = '';
            document.getElementById('result51days').innerText = '';
            document.getElementById('label12').innerText = '';
            document.getElementById('label13').innerText = '';
            document.getElementById('message-duration').innerText = '';
            document.getElementById('message-51days').innerText = '';
            document.getElementById('message-balance').innerText = '';

            // إعادة تعيين الراديو بوتنز
            document.querySelectorAll('input[name="duration"]').forEach(function(radio) {
                radio.checked = false;
            });
        });
    </script>
</body>
</html>
